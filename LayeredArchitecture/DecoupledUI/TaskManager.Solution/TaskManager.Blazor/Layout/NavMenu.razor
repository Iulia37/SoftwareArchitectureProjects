@using Blazored.SessionStorage
@using TaskManager.DTO.Models
@inject ISessionStorageService SessionStorage
@inject NavigationManager NavigationManager

<div class="mt-3">
    <h4 class="m-3">TaskManager</h4>
    @if (loggedUser != null)
    {
        <NavLink class="nav-link mt-5" href="/projects" Match="NavLinkMatch.All">Projects</NavLink>
        <NavLink class="nav-link mt-3" href=@($"/projects/create/{loggedUser.Id}")>Add Project</NavLink>
        <NavLink class="nav-link mt-3" href="@($"/users/show/{loggedUser.Id}")">Account settings</NavLink>
    }
</div>

@code {
    UserDTO loggedUser;

    protected override async Task OnInitializedAsync()
    {
        loggedUser = await SessionStorage.GetItemAsync<UserDTO>("user");
    }

    async Task Logout()
    {
        await SessionStorage.RemoveItemAsync("user");
        loggedUser = null;
        NavigationManager.NavigateTo("/", true);
    }
}